<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <title>Keybase Book: </title>
    <meta name="description" content="" />
    <meta name="robots" content="index,follow" />
    <link rel="stylesheet" href="/static/css/style.css" />
    <link rel="stylesheet" href="/static/css/custom.css" />

    <!-- Favicon -->
    <link rel="apple-touch-icon" sizes="180x180" href="/static/favicon/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/static/favicon/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/static/favicon/favicon-16x16.png">
    <link rel="manifest" href="/static/favicon/site.webmanifest">
    <link rel="mask-icon" href="/static/favicon/safari-pinned-tab.svg" color="#030303">
    <meta name="msapplication-TileColor" content="#f0f0f0">
    <meta name="theme-color" content="#f0f0f0">

    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:site" content="@KeybaseIO">
    <meta name="twitter:creator" content="@KeybaseIO">
    <meta name="twitter:title" content="Keybase Book">
    <meta name="twitter:description" content="Use Keybase for end-to-end encrypted chat messaging, file sharing, and team collaboration. Get the free app for iOS, Mac, Android, Windows, and Linux.">
    <meta name="twitter:image" content="/static/img/twitter-card.jpg">

    <script>
    function url_for(filename) {
        const prefix = "";
        const STATIC_ASSET_MAP = {};

        if (STATIC_ASSET_MAP.hasOwnProperty(filename)) {
            return prefix + STATIC_ASSET_MAP[filename] + "/" + filename;
        }

        return prefix + filename;
    }
    </script>
  </head>
  <body>

    <div class="app">
      <nav class="site-nav">
            <a class="site-nav__brand" href="/">Keybase&nbsp;<span>Book</span></a>
            
            <div class="site-nav__actions">
                
                <a class="site-nav__jump site-nav__jump--primary" href="https://book.keybase.io/guides/pgp-in-javascript" target="_blank">查看原版</a>
                <a class="site-nav__jump" href="https://keybase.io">前往 keybase.io</a>
            </div>
        </nav>
      <main class="main">
        
    <div class="content">
        
        <div class="side-nav side-nav--extended">
        <nav class="chapter-nav">
            <p class="chapter-nav__label">指南</p>
            
            <ol class="chapter-nav__list">
                
                
                <li class="chapter-nav__list-item">
                    <a href="/guides/command-line" class="chapter-nav__link">命令行</a>
                    
                </li>
                
                
                <li class="chapter-nav__list-item">
                    <a href="/guides/linux" class="chapter-nav__link">Linux 用户指南</a>
                    
                </li>
                
                
                <li class="chapter-nav__list-item">
                    <a href="/guides/pgp-in-javascript" class="chapter-nav__link chapter-nav__link--active">kbpgp.js</a>
                    
                    <ol class="chapter-nav__nested-list">
                        
                        <li class="chapter-nav__nested-list-item">
                             <a href="/guides/pgp-in-javascript#key-manager-密钥管理器" class="chapter-nav__nested-link">Key Manager (密钥管理器)</a>
                        </li>
                        
                    </ol>
                    
                </li>
                
            </ol>
            <a href="/account" class="chapter-nav__back">返回章节列表</a>
        </nav>
    </div>
        
        <div class="content__inner">
            <section id="overview" class="content__section">
                <h1 id="javascript-中的-pgp">JavaScript 中的 PGP</h1>
<p><em>kbpgp</em> 是 Keybase 的 JavaScript PGP 实现。它易于使用，专为并发设计，并且在 Node.js 和浏览器中都很稳定。它目前正在积极维护中，并基于 BSD 许可证永久属于你。本页开始一个简短的教程。</p>
<p>{# TODO: JavaScript mini app thing from https://keybase.io/kbpgp #}</p>
<h3 id="获取它">获取它</h3>
<p>Zip 文件（用于浏览器）</p>
<ul>
<li><a href="https://keybase.io/kbpgp_public/releases/kbpgp-2.1.0-release.zip">kbpgp-2.1.0-release.zip</a></li>
</ul>
<p>用于 Node.js（通过 NPM）</p>
<pre class="codehilite"><code>npm install kbpgp
</code></pre>

<p>源码来自 <a href="https://github.com/keybase/kbpgp">GitHub</a></p>
<pre class="codehilite"><code>git clone https://github.com/keybase/kbpgp.git
</code></pre>

<h3 id="入门">入门</h3>
<p>浏览器</p>
<pre class="codehilite"><code>&lt;script src=&quot;kbpgp-2.1.0.js&quot;&gt;&lt;/script&gt;
</code></pre>

<p>Node.js</p>
<pre class="codehilite"><code>var kbpgp = require('kbpgp');
</code></pre>

<h2 id="key-manager-密钥管理器">Key Manager (密钥管理器)</h2>
<p><em>在执行任何加密操作之前，你需要一个 KeyManager。</em></p>
<p>一个 KeyManager 包含一个公钥，可能还包含特定人员的私钥和子钥。一旦你有了一个 KeyManager 实例，你就可以使用其中的密钥执行操作。对于签名和加密操作，你需要两个 KeyManager：一个包含私钥（用于签名者），另一个包含公钥（用于接收者）。</p>
<p>例如，假设我们要执行加密，且有两个 KeyManager 实例：<code>alice</code> 和 <code>chuck</code>。</p>
<pre class="codehilite"><code class="language-javascript">var params = {
  encrypt_for: chuck,
  sign_with:   alice,
  msg:         &quot;Hey Chuck - my bitcoin address is 1alice12345234...&quot;
};

kbpgp.box(params, function(err, result_string, result_buffer) {
  console.log(err, result_string, result_buffer);
});
</code></pre>

<p>kbpgp 的 <code>box</code> 函数执行所有工作。请注意，它会回调返回字符串和 Buffer 表示形式。Buffer 要么是 <a href="http://nodejs.org/api/buffer.html">Node.js Buffer</a>，要么是具有类似功能的浏览器友好对象。</p>
<p>很简单，对吧？那么，如何获得 KeyManager 呢？有 2 种方法：</p>
<ul>
<li><a href="#loading-a-key">加载密钥或密钥对</a></li>
<li><a href="#generating-a-pair">生成新的密钥对</a></li>
</ul>
<h3 id="加载密钥"><a id="loading-a-key"></a>加载密钥</h3>
<p>以下示例演示了将 PGP 密钥字符串（经典 ASCII armored 格式）转换为 KeyManager 的过程。</p>
<h4 id="示例-1---从公钥创建-keymanager">示例 1 - 从公钥创建 KeyManager</h4>
<pre class="codehilite"><code class="language-javascript">var alice_pgp_key = &quot;-----BEGIN PGP PUBLIC ... etc.&quot;;

kbpgp.KeyManager.import_from_armored_pgp({
  armored: alice_pgp_key
}, function(err, alice) {
  if (!err) {
    console.log(&quot;alice is loaded&quot;);
  }
});
</code></pre>

<h4 id="示例-2---从私钥创建-keymanager">示例 2 - 从私钥创建 KeyManager</h4>
<p>现在假设我们有 alice 的私钥。回想一下，这包含了她的公钥，所以这就是我们需要的一切。</p>
<pre class="codehilite"><code class="language-javascript">var alice_pgp_key    = &quot;-----BEGIN PGP PRIVATE ... etc.&quot;;
var alice_passphrase = &quot;martian-dung-flinger&quot;;

kbpgp.KeyManager.import_from_armored_pgp({
  armored: alice_pgp_key
}, function(err, alice) {
  if (!err) {
    if (alice.is_pgp_locked()) {
      alice.unlock_pgp({
        passphrase: alice_passphrase
      }, function(err) {
        if (!err) {
          console.log(&quot;Loaded private key with passphrase&quot;);
        }
      });
    } else {
      console.log(&quot;Loaded private key w/o passphrase&quot;);
    }
  }
});
</code></pre>

<h4 id="示例-3---从公钥创建-keymanager然后添加私钥">示例 3 - 从公钥创建 KeyManager，然后添加私钥</h4>
<p>上面的示例 (<a href="example-2-a-keymanager-from-a-private-key">#2</a>) 可以分两步执行。你可以使用 alice 的公钥创建一个 KeyManager 实例，然后将她的私钥添加到其中。如果她的私钥与公钥不匹配，这将产生错误。</p>
<pre class="codehilite"><code class="language-javascript">var alice_public_key = &quot;-----BEGIN PGP PUBLIC ... etc.&quot;;
var alice_private_key = &quot;-----BEGIN PGP PRIVATE ... etc.&quot;;
var alice_passphrase = &quot;ovarian fred savage &quot;;

kbpgp.KeyManager.import_from_armored_pgp({
  armored: alice_public_key
}, function(err, alice) {
  if (!err) {
    alice.merge_pgp_private({
      armored: alice_private_key
    }, function(err) {
      if (!err) {
        if (alice.is_pgp_locked()) {
          alice.unlock_pgp({
            passphrase: alice_passphrase
          }, function(err) {
            if (!err) {
              console.log(&quot;Loaded private key with passphrase&quot;);
            }
          });
        } else {
          console.log(&quot;Loaded private key w/o passphrase&quot;);
        }
      }
    });
  }
});
</code></pre>

<h3 id="生成密钥对"><a id="generating-a-pair"></a>生成密钥对</h3>
<p>你可以创建一个 KeyManager 并一次性生成新密钥。</p>
<p>在以下过程结束时，我们将拥有一个 KeyManager 实例 <code>alice</code>，它可用于任何加密操作。</p>
<h4 id="示例-1---rsa---使用自定义设置">示例 1 - RSA - 使用自定义设置</h4>
<p>为了说明一个常见用例，我们将为签名和加密生成子钥。顺便说一句，当 kbpgp 使用 KeyManager 执行操作时，它会自动选择合适的子钥。</p>
<pre class="codehilite"><code class="language-javascript">var F = kbpgp[&quot;const&quot;].openpgp;

var opts = {
  userid: &quot;User McTester (Born 1979) &lt;user@example.com&gt;&quot;,
  primary: {
    nbits: 4096,
    flags: F.certify_keys | F.sign_data | F.auth | F.encrypt_comm | F.encrypt_storage,
    expire_in: 0  // never expire
  },
  subkeys: [
    {
      nbits: 2048,
      flags: F.sign_data,
      expire_in: 86400 * 365 * 8 // 8 years
    }, {
      nbits: 2048,
      flags: F.encrypt_comm | F.encrypt_storage,
      expire_in: 86400 * 365 * 8
    }
  ]
};

kbpgp.KeyManager.generate(opts, function(err, alice) {
  if (!err) {
    // sign alice's subkeys
    alice.sign({}, function(err) {
      console.log(alice);
      // export demo; dump the private with a passphrase
      alice.export_pgp_private ({
        passphrase: 'booyeah!'
      }, function(err, pgp_private) {
        console.log(&quot;private key: &quot;, pgp_private);
      });
      alice.export_pgp_public({}, function(err, pgp_public) {
        console.log(&quot;public key: &quot;, pgp_public);
      });
    });
  }
});
</code></pre>

<p>太简单了！</p>
<h4 id="示例-2---rsa---使用合理的默认值">示例 2 - RSA - 使用合理的默认值</h4>
<p>上面的参数是合理的。如果你对它们满意，可以直接调用 <code>KeyManager::generate_rsa</code> 快捷方式：</p>
<pre class="codehilite"><code class="language-javascript">kbpgp.KeyManager.generate_rsa({ userid : &quot;Bo Jackson &lt;user@example.com&gt;&quot; }, function(err, charlie) {
   charlie.sign({}, function(err) {
     console.log(&quot;done!&quot;);
   });
});   
</code></pre>

<h3 id="示例-3---ecc-密钥对---自定义">示例 3 - ECC 密钥对 - 自定义</h3>
<p>Kbpgp 支持椭圆曲线 PGP (有关详细信息，请参阅 <a href="http://tools.ietf.org/html/rfc6637">RFC-6637</a>)。你可以向上述生成调用提供 <code>ecc : true</code> 选项，以生成 ECC 密钥对而不是标准 PGP 密钥对。但请记住，目前大多数 GPG 客户端并不支持 ECC。</p>
<pre class="codehilite"><code class="language-javascript">var F = kbpgp[&quot;const&quot;].openpgp;

var opts = {
  userid: &quot;User McTester (Born 1979) &lt;user@example.com&gt;&quot;,
  ecc:    true,
  primary: {
    nbits: 384,
    flags: F.certify_keys | F.sign_data | F.auth | F.encrypt_comm | F.encrypt_storage,
    expire_in: 0  // never expire
  },
  subkeys: [
    {
      nbits: 256,
      flags: F.sign_data,
      expire_in: 86400 * 365 * 8 // 8 years
    }, {
      nbits: 256,
      flags: F.encrypt_comm | F.encrypt_storage,
      expire_in: 86400 * 365 * 8
    }
  ]
};

kbpgp.KeyManager.generate(opts, function(err, alice) {
  // as before...
});
</code></pre>

<h4 id="示例-4---ecc-密钥对---使用合理的默认值">示例 4 - ECC 密钥对 - 使用合理的默认值</h4>
<p>为了使用这些默认参数，我们同样提供了快捷方式：</p>
<pre class="codehilite"><code class="language-javascript">kbpgp.KeyManager.generate_ecc({ userid : &quot;&lt;user@example.com&gt;&quot; }, function(err, charlie) {
   charlie.sign({}, function(err) {
     console.log(&quot;done!&quot;);
   });
});
</code></pre>

<h4 id="监控">监控</h4>
<p>所有 kbpgp 函数都支持传递一个“异步包” (ASync Package, ASP) 对象，用于监控。你的 ASP 可以有一个 progress_hook 函数，它将随进度信息被调用。这对于 RSA 密钥生成特别重要，因为它可能需要一点时间。如果这是在任何类型的客户端应用程序中，你会希望 (a) 显示一些指示器表明你正在工作，以及 (b) 有一个取消按钮。</p>
<pre class="codehilite"><code class="language-javascript">var my_asp = new kbpgp.ASP({
  progress_hook: function(o) {
    console.log(&quot;I was called with progress!&quot;, o);
  }
});

var opts = {
  asp: my_asp,
  userid: &quot;user@example.com&quot;,
  primary: {
    nbits: 4096
  },
  subkeys: []
};

kbpgp.KeyManager.generate(opts, some_callback_function);
</code></pre>

<h4 id="取消">取消</h4>
<p>如果你如上所述传递了一个 ASP 对象，你可以使用它来取消你的进程。</p>
<pre class="codehilite"><code class="language-javaascript">kbpgp.KeyManager.generate(opts, some_callback_function);

// oh, heck, let's give up if it takes more than a second
setTimeout((function() {
  my_asp.canceler.cancel();
}), 1000);
</code></pre>

<p>在上面的例子中，如果生成未在一秒内完成，工作将停止，并且 <code>some_callback_function</code> 将立即被调用，参数为 <code>err, null</code>。</p>
<h3 id="api">API</h3>
<p>给定 <code>KeyManager</code> 类 (<code>kbpgp.KeyManager</code>) 和一个实例 <code>alice</code>，你可以访问以下函数。</p>
<h4 id="首先选项说明">首先，选项说明</h4>
<ol>
<li>当 <code>opts</code> 作为参数时，它是一个字典。你可以传递空字典 <code>{}</code></li>
<li>在任何 kbpgp 函数中，你可以设置 <code>opts.asp</code> 为一个 ASP 对象来监控进度并可选地取消它。有关更多信息，请参阅示例。</li>
</ol>
<p>{# TODO: table #}</p>
<ul>
<li><code>KeyManager.generate(opts, cb)</code> <code>KeyManager.generate_rsa(opts, cb)</code> <code>KeyManager.generate_ecc(opts, cb)</code>: 回调返回 <code>err, key_manager</code> (<a href="#generating-a-pair">见示例</a>)</li>
<li><code>KeyManager.import_from_armored_pgp(opts, cb)</code>: 回调返回 <code>err, key_manager</code>。如果你正在导入私钥，你会想要检查它是否有密码并解锁它。(<a href="#loading-a-key">见示例</a>)</li>
<li><code>alice.has_pgp_private()</code>: 如果 alice 的 <code>key_manager</code> 包含私钥，则返回 true</li>
<li><code>alice.is_pgp_locked()</code>: 如果 alice 的私钥受密码保护且已锁定，则返回 true</li>
<li><code>alice.unlock_pgp(opts, cb)</code>: 如果 alice 的私钥已锁定，则解锁它；回调返回任何错误 (<a href="#loading-a-key">见示例</a>)；<code>opts.passphrase</code>: 包含 alice 私钥密码的字符串</li>
<li><code>alice.check_pgp_public_eq(chuck)</code>: 如果 alice 和另一个 KeyManager 实例 (chuck) 具有相同的主键和子键，则返回 true</li>
<li><code>alice.merge_pgp_private(opts, cb)</code>: 如果 alice 加载时没有私钥，此函数允许你事后合并她的私钥。一旦合并，如果它是密码保护的，你会想要 (a) 用 <code>alice.is_pgp_locked()</code> 识别它，然后 (b) 用 <code>alice.unlock_pgp_key()</code> 解锁它；<code>opts.armored</code>: 包含她私钥的字符串（armored 格式）</li>
<li><code>alice.export_pgp_public(opts, cb)</code>: 回调返回 <code>err, str</code>。这将生成 alice 公钥的标准 PGP armored 格式。(<a href="#generating-a-pair">见示例</a>)</li>
<li><code>alice.export_pgp_private(opts, cb)</code>: 回调返回 <code>err, str</code>。这将生成 alice 密钥的标准 PGP armored 格式，受密码保护。(<a href="#generating-a-pair">见示例</a>)；<code>opts.passphrase</code>: 保护密钥的密码</li>
</ul>
<h3 id="加密和或签名">加密和/或签名</h3>
<p>在 kbpgp 中，加密、签名或两者兼有的步骤都是相同的。唯一的区别是你需要什么 <a href="#key-manager">KeyManager</a>。要签名某些东西，你需要一个包含私钥的 KeyManager。要加密某些东西，你需要一个包含接收者公钥的 KeyManager。如果你的 KeyManager 包含子钥，kbpgp 将自动使用合适的子钥。</p>
<h4 id="示例-1---仅加密">示例 1 - 仅加密</h4>
<p>假设：我们有一个 KeyManager 实例 <code>chuck</code>，用于接收者。</p>
<pre class="codehilite"><code class="language-javascript">var params = {
  msg:         &quot;Chuck chucky, bo-bucky!&quot;,
  encrypt_for: chuck
};

kbpgp.box(params, function(err, result_string, result_buffer) {
  console.log(err, result_armored_string, result_raw_buffer);
});
</code></pre>

<h4 id="示例-2---仅签名">示例 2 - 仅签名</h4>
<p>同样，签署明文消息很容易。只需提供 <code>sign_with</code> KeyManager，但不提供 <code>encrypt_for</code>。</p>
<pre class="codehilite"><code class="language-javascript">var params = {
  msg:        &quot;Here is my manifesto&quot;,
  sign_with:  alice
};

kbpgp.box (params, function(err, result_string, result_buffer) {
  console.log(err, result_string, result_buffer);
});
</code></pre>

<h4 id="示例-3---签名--加密">示例 3 - 签名 + 加密</h4>
<p>假设：我们也有一个 KeyManager 实例 <code>alice</code>，用于发送者。</p>
<pre class="codehilite"><code class="language-javascript">var params = {
  msg:         &quot;Chuck chucky, bo-bucky! This is Alice here!&quot;,
  encrypt_for: chuck,
  sign_with:   alice
};

kbpgp.box (params, function(err, result_string, result_buffer) {
  console.log(err, result_string, result_buffer);
});
</code></pre>

<h4 id="示例-4---使用输入和输出-buffer">示例 4 - 使用输入和输出 Buffer</h4>
<p>kbpgp 可以接受 <em>Node.js Buffer</em> 作为输入，而不是字符串。以下代码读取 .png 文件并写入一个新的加密副本。有关更多信息，请查看 kbpgp <a href="#files-and-buffers">buffers</a> 文档。</p>
<pre class="codehilite"><code class="language-javaascript">var kbpgp  = require('kbpgp');
var fs     = require('fs');
var buffer = fs.readFileSync('dirty_deeds.png');
var params = {
  msg:         buffer,
  encrypt_for: chuck,
  sign_with:   alice
};

kbpgp.box (params, function(err, result_string, result_buffer) {
  fs.writeFileSync('dirty_deeds.encrypted', result_buffer);
});
</code></pre>

<p>浏览器中也可以使用 Buffer，以便对文件进行 HTML5 操作。<code>kbpgp.Buffer</code> 提供了与 Node.js 匹配的浏览器实现。</p>
<h4 id="示例-5---进度钩子和取消">示例 5 - 进度钩子和取消</h4>
<p>大多数 kbpgp 函数都可以接受一个 <code>kbpgp.ASP</code> 对象，用于监控进度并检查取消请求。</p>
<pre class="codehilite"><code class="language-javascript">var asp = new kbpgp.ASP({
  progress_hook: function(info) {
    console.log(&quot;progress...&quot;, info);
  }
});

var params = {
  msg:         &quot;a secret not worth waiting for&quot;,
  encrypt_for: chuck,
  asp:         asp
};

kbpgp.box(params, function(err, result_string, result_buffer) {
  console.log(&quot;Done!&quot;, err, result_string, result_buffer);
});

// sometime before it's done
asp.canceler().cancel();
</code></pre>

<h3 id="解密和验证">解密和验证</h3>
<p>解密和验证比加密或签名稍微复杂一些，因为通常你不知道通过什么 KeyManager。对于签名和加密的 PGP 消息，你只有在成功解密后才知道需要哪个验证密钥。此外，PGP 中的消息可以为多个接收者加密，任何给定的接收者可能只能访问许多可能的解密密钥中的一个。</p>
<p>在 kbpgp 中，<code>unbox</code> 函数处理解密和验证的细节。你需要传递给它一个 PGP 消息（加密、签名或两者兼有），以及一种中途获取密钥的方法——一个 <code>kbpgp.KeyFetcher</code> 对象。你可以直接使用我们提供的，也可以子类化你自己的（例如，如果你想从你的服务器获取密钥）。</p>
<h4 id="开箱即用keyring">开箱即用：KeyRing</h4>
<pre class="codehilite"><code class="language-javascript">var ring = new kbpgp.keyring.KeyRing();
var kms = [ alice, bob, charlie ];
for (var i in kms) {
  ring.add_key_manager(kms[i]);
}
</code></pre>

<h4 id="解密和验证示例">解密和验证示例</h4>
<p>通过 <code>unbox</code> 函数解密并验证。传递消息、KeyFetcher（如上面的 <code>ring</code>）、ASP（如果你打算取消或监控进度），以及完成时触发的回调：</p>
<pre class="codehilite"><code class="language-javascript">var ring = new kbpgp.keyring.KeyRing;
var kms = [alice, bob, charlie];
var pgp_msg = &quot;---- BEGIN PGP MESSAGE ----- ....&quot;;
var asp = /* as in Encryption ... */;
for (var i in kms) {
  ring.add_key_manager(kms[i]);
}
kbpgp.unbox({keyfetch: ring, armored: pgp_msg, asp }, function(err, literals) {
  if (err != null) {
    return console.log(&quot;Problem: &quot; + err);
  } else {
    console.log(&quot;decrypted message&quot;);
    console.log(literals[0].toString());
    var ds = km = null;
    ds = literals[0].get_data_signer();
    if (ds) { km = ds.get_key_manager(); }
    if (km) {
      console.log(&quot;Signed by PGP fingerprint&quot;);
      console.log(km.get_pgp_fingerprint().toString('hex'));
    }
  }
});
</code></pre>

<p><code>unbox</code> 回调有两个参数：如果出错则为 Error，否则为 <code>Literals</code> 数组。<code>Literal</code> 对象支持 <code>toString(enc)</code> 和 <code>toBuffer()</code> 方法。前者调用接受一个可选参数，即编码；如果没有提供，kbpgp 将使用 PGP 消息中指定的编码；如果你想覆盖该编码，可以指定 <code>utf8</code>、<code>ascii</code>、<code>binary</code>、<code>base64</code> 或 <code>hex</code>。</p>
<p>此示例表明 <code>unbox</code> 处理解密和验证。要检查消息的某些部分是否已签名，请对消息中的每个 <code>Literal</code> 调用 <code>get_data_signer</code>。请注意，你加载到 KeyFetcher 中的同一个 KeyManager 会出现在这里。因此，如果你用自定义字段扩充该 KeyManager，它们将在此处可用。</p>
<h4 id="keyfetcher-接口">KeyFetcher 接口</h4>
<p>在更通用的解密/验证场景中，你可能需要从辅助或远程存储中获取适当的解密和/或验证密钥。在这种情况下，你不应该使用上述的 KeyRing，而应该提供一个自定义的 KeyFetcher。</p>
<p>所有可用的 KeyFetcher 必须实现一个方法：<code>fetch</code>。给定几个 PGP 密钥 ID 和一个指定请求操作的标志，fetch 方法应该回调返回一个 <code>KeyManager</code>（如果能找到）。</p>
<p><code>fetch(ids,ops,cb)</code> 调用有三个参数：</p>
<ol>
<li><code>ids</code>—<a href="#files-and-buffers">Buffers</a> 数组，每个都包含一个 PGP 密钥的 64 位 ID。这些密钥可能引用子钥，通常用于加密和签名消息。</li>
<li><code>ops</code>—此密钥所需的加密选项；<code>kbpgp.const.ops</code> 中常量的按位或，包括：<ul>
<li>encrypt : <code>0x1</code></li>
<li>decrypt : <code>0x2</code></li>
<li>verify : <code>0x4</code></li>
<li>sign : <code>0x8</code></li>
</ul>
</li>
<li><code>cb</code>—完成时的回调，回调返回一个三元组：<code>(err,km,i)</code><ul>
<li><code>err</code> 是解释出错原因的 Error，成功则为 null。</li>
<li><code>km</code> 是（成功时）满足给定要求的 KeyManager</li>
<li><code>i</code> 是（成功时）指示在查找中找到了哪个密钥的整数。如果此处返回 <code>0</code>，则 <code>ids[0]</code> 是 <code>km</code> 内密钥的 64 位 ID。</li>
</ul>
</li>
</ol>
<h3 id="文件和-buffer"><a id="files-and-buffers"></a>文件和 Buffer</h3>
<p><em>在大多数示例中，我们处理的是字符串明文和密文。当然，有时你想要读取和写入文件并转换为有趣的字符串，如 hex 或 base64。</em></p>
<p>回想一下，当我们加密时，我们期望消息是一个字符串：</p>
<pre class="codehilite"><code class="language-javascript">var params = {
  msg: &quot;Chuck chucky, bo-bucky!&quot;,
  encrypt_for: chuck // a KeyManager instance
};
</code></pre>

<p>在 Node.js 中，我们可以传递一个 <a href="http://nodejs.org/api/buffer.html">Node.js Buffer</a>。这可以来自文件。请记住，此文件的 Buffer 和输出需要能轻松放入内存。（对于任意大的文件，kbpgp 未来将支持流。）</p>
<pre class="codehilite"><code class="language-javascript">fs.readFile('foo.png', function(err, buff) {
  var params = {
    msg:         buff,
    encrypt_for: chuck
  };
});
</code></pre>

<p>在浏览器中，我们有类似的 Buffer 可用：<code>kbpgp.Buffer</code>。它的行为与 Node.js buffer 完全相同，这要归功于 <a href="https://github.com/substack/native-buffer-browserify">native-buffer-browserify</a>。</p>
<pre class="codehilite"><code class="language-javascript">// using a string as a Buffer, in the browser
var params = {
  msg:         kbpgp.Buffer.from(&quot;Chuck chucky, bo-bucky!&quot;),
  encrypt_for: chuck
};
</code></pre>

<h4 id="输出-buffer">输出 Buffer</h4>
<p>kbpgp 的 <code>burn</code> 函数回调返回 result_string（加密或签名时的 armored 字符串）和 result_buffer（只是原始二进制数据）。后者要么是 Node.js Buffer（如上所述），要么在浏览器中是 <code>kbpgp.Buffer</code>。</p>
<pre class="codehilite"><code class="language-javascript">kbpgp.burn(params, function(err, result_string, result_buffer) {
  console.log(result_buffer.toString('hex'));
  console.log(result_buffer.toString('base64'));
  // etc...
  // ...these work in both the browser and Node.js
});
</code></pre>

<h4 id="在浏览器中使用-html5">在浏览器中，使用 HTML5</h4>
<p>如果你想在浏览器中支持文件处理，你可以使用 HTML5 <code>FileReader</code> 并将文件内容转换为 Buffer，就在客户端。根据浏览器的不同，你会有内存限制。</p>
<pre class="codehilite"><code class="language-javascript">var f = some_html_5_file_object;
var r = new FileReader();   // modern browsers have this
r.readAsBinaryString(f);
r.onloadend = function(file) {
  var buffer = kbpgp.Buffer.from(r.result);
  // ... now process it using kbpgp
};
</code></pre>

<h3 id="faq">FAQ</h3>
<h4 id="本文档缺少某些内容我该如何______">本文档缺少某些内容——我该如何______？</h4>
<p>kbpgp 网站是全新的，我们才刚刚开始编写文档。请在 <a href="https://github.com/keybase/kbpgp/issues">GitHub issues</a> 中告诉我们。</p>
<h4 id="你说的专为并发设计是什么意思">你说的“专为并发设计”是什么意思？</h4>
<p>加密是 CPU 密集型的。最糟糕的是 RSA 密钥对生成，此时我们要寻找巨大的素数。这加上 JavaScript 的单线程特性简直是一场噩梦。看看这个有趣的东西：</p>
<pre class="codehilite"><code class="language-javascript">weird_sum = function() {
  var x = 0;
  for (var i = 0; i &lt; 10000000; i++) {
    x -= Math.cos(Math.PI)
  }
  return x;
};
console.log(weird_sum());
</code></pre>

<p>上述函数在浏览器中可能需要几秒钟，在此期间它将无响应——没有其他 JavaScript 可以运行，没有按钮或链接可以点击，什么都没有。它会暂停你美好的生活体验。在 Node.js 中，你的整个进程将锁定，你会去下载 Go。</p>
<p>浏览器中的一种解决方案是将此过程转移到 Web Worker。这通常有效，尽管 Web Worker 是新的并且有些错误（在撰写本文时，让 Chrome 崩溃并不难），而且它们有很高的开销。在 Node 方面，你可以运行一个单独的进程来执行数学运算，并向其发送 RPC。（旁注：无论如何这都是个好主意。）</p>
<p>无论你在哪里运行它，繁重的数学运算都可以考虑到单线程并发来编写。你只需要 (1) 分批工作，(2) 通过 <code>setTimeout</code> 或 <code>process.nextTick</code> 定期服从事件循环，以及 (3) 回调返回答案，而不是直接返回。一个简单的例子：</p>
<pre class="codehilite"><code class="language-javascript">var _batch = function(a, batch_size, stop_at, cb) {
  var b, i, sum, _i;
  b = Math.min(stop_at, a + batch_size);
  sum = 0;
  for (i = _i = a; a &lt;= b ? _i &lt; b : _i &gt; b; i = a &lt;= b ? ++_i : --_i) {
    sum -= Math.cos(Math.PI);
  }
  if ((a = b) === stop_at) {
    cb(sum);
  } else {
    setTimeout(function() {
      _batch(a, batch_size, stop_at, function(sub_sum) {
        cb(sum + sub_sum);
      });
    }, 0);
  }
};

var weird_sum = function(cb) {
  _batch(0, 100000, 10000000, cb);
};

weird_sum(function(sum) {
  console.log(sum);
});
</code></pre>

<p>编写这样的代码——通过回调返回答案——是具有传染性的。如果 foo 调用 bar，bar 回调返回答案，foo 不能直接返回该答案。它也必须回调。</p>
<p>所有 kbpgp 都是这样编写的，尽管比上面的例子稍微漂亮一点。此外，kbpgp 支持中止和进度钩子函数，不像上面的例子。总之，你可以在与其他代码相同的线程上运行 kbpgp，没有任何问题。</p>
<h4 id="为什么你们使用-coffeescript或者更确切地说icedcoffeescript">为什么你们使用 CoffeeScript？或者更确切地说，IcedCoffeeScript？</h4>
<p>我们认为 CoffeeScript 是对 JavaScript 的巨大改进，因为它可以编写更简洁、更易读的代码。至于 <a href="http://maxtaco.github.io/coffee-script/">IcedCoffeeScript</a>，是我们写的！嗯，具体来说是 Max fork 了 CoffeeScript。IcedCoffeeScript 与 CoffeeScript 相同，但有两个新增功能（<code>await</code> 和 <code>defer</code>），使异步编程更加美好。请注意我们在上面的示例中完全没有 worker 函数，转换为 Iced：</p>
<pre class="codehilite"><code class="language-coffeescript">weird_sum = (cb) -&gt;
  x = 0
  for i in [0...10000000]
    x -= Math.cos Math.PI
    if not (x % 10000)
      await setTimeout defer(), 0
  cb x
</code></pre>

<p>当然，作为我们构建过程的一部分，kbpgp 被编译为 JavaScript，因此你不需要使用 CoffeeScript 就可以使用它。</p>
<h4 id="为什么你们不直接在-keybase-中使用-openpgpjs-或-google-的-end-to-end">为什么你们不直接在 Keybase 中使用 OpenPGP.js 或 Google 的 End-to-End？</h4>
<p>在撰写本文时，Google 的 End-to-End 需要椭圆曲线密钥生成——这与最流行的 PGP 实现不兼容。kbpgp 可以生成和处理 RSA 和 EC 密钥，因此它旨在与 GPG 和其他 PGP 实现配合使用。</p>
<p>至于 OpenPGP.js，在 2013 年底，我们查看了 OpenPGP.js。不幸的是，当时我们看到了一些我们不喜欢的东西。这已在别处讨论过，Google 团队也对此发表了评论。我们没有审查 OpenPGP.js 的当前状态。</p>
<h3 id="野外应用">野外应用！</h3>
<p>这些是使用 kbpgp 的社区项目。如果你做了一些很酷的事情（发送电子邮件至 <code>chris@keybase.io</code>），我们会添加你。Keybase 团队和 KBPGP 贡献者未审核且<strong>不负责</strong>以下项目。</p>
<ul>
<li><a href="https://apps.crp.to/encrypt?type=e">OnlyKey WebCrypt</a>，一个无服务器 Web 应用程序，与 <a href="https://crp.to/p/">OnlyKey</a> 和 Keybase 集成，随时随地提供 PGP 加密。</li>
<li><a href="https://playtopsecret.com/demo.html">Top Secret</a>，一款受斯诺登泄密事件启发的游戏。(<a href="https://www.kickstarter.com/projects/1928653683/top-secret-a-game-about-the-snowden-leaks">Kickstarter</a>)</li>
<li><a href="https://pgpkeygen.com/">pgpkeygen.com</a>，一个使用 kbpgp 的在线 PGP 密钥生成器。</li>
<li><a href="https://fncontact.com/pgpkeys">fnContact.com/pgpkeys</a>，一个使用 kbpgp 的在线 PGP 密钥生成器。</li>
<li><a href="https://thechiefmeat.github.io/pgp/">PGP generator</a>，一个用于浏览器中 PGP 的网站</li>
</ul>
<hr />
<p>我们的教程和示例才刚刚开始。如果缺少任何内容，请<a href="https://github.com/keybase/kbpgp">在 GitHub 上</a>联系我们。</p>
            </section>
        </div>
    </div>
    <script src="/static/js/Nav.js" type="module" async></script>

    
        <script src="/static/js/vendor/gsap.min.js"></script>
        <script src="/static/js/vendor/katex.min.js"></script>
        <script src="/static/js/vendor/auto-render.min.js"></script>
        <script src="/static/js/docs.js" type="module" async></script>
    
      </main>
    </div>
    <footer class="site-footer">
  <div class="site-footer__inner">
    <a class="site-footer__brand" href="/">Keybase&nbsp;<span>Book</span></a>
    <ul class="site-footer__list">
      <li class="site-footer__list-item">
        <a class="site-footer__link" href="https://keybase.io/">Keybase Home</a>
      </li>
      <li class="site-footer__list-item">
        <a class="site-footer__link" href="https://github.com/keybase/book-content/issues">Bug Reporting</a>
      </li>
      <li class="site-footer__list-item">
        <a class="site-footer__link" href="https://keybase.io/docs/terms">Terms</a>
      </li>
      <li class="site-footer__list-item">
        <a class="site-footer__link" href="https://keybase.io/docs/privacypolicy">Privacy</a>
      </li>
      <li class="site-footer__list-item">
        <a class="site-footer__link" href="https://keybase.io/docs/acceptable-use-policy">Acceptable Use</a>
      </li>
    </ul>
    


<template id="link-android">
    <a href="https://keybase.io/_/download/keybase-for-android" class="download__button" aria-label="Download Keybase"><img src="https://keybase.io/images/getting-started/play_store_badge_320x94.png" alt="" style="width: 120px;"></a>
    <a class="download__link" href="https://keybase.io/download">Also available for iOS, Linux, Mac OS, and Windows</a>
</template>

<template id="link-ios">
    <a href="https://keybase.io/_/download/keybase-for-ios" class="download__button" aria-label="Download Keybase">
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 119.664 40">
    <path
    d="M110.135 0H9.535c-.367 0-.73 0-1.095.002-.306.002-.61.008-.919.013A13.215 13.215 0 005.517.19a6.665 6.665 0 00-1.9.627 6.438 6.438 0 00-1.62 1.18A6.258 6.258 0 00.82 3.617 6.601 6.601 0 00.195 5.52a12.993 12.993 0 00-.179 2.002c-.01.307-.01.615-.015.921V31.56c.005.31.006.61.015.921a12.992 12.992 0 00.18 2.002 6.588 6.588 0 00.624 1.905A6.208 6.208 0 001.998 38a6.274 6.274 0 001.618 1.179 6.7 6.7 0 001.901.63 13.455 13.455 0 002.004.177c.31.007.613.011.919.011.366.002.728.002 1.095.002h100.6c.36 0 .724 0 1.084-.002.304 0 .617-.004.922-.01a13.279 13.279 0 002-.178 6.804 6.804 0 001.908-.63A6.277 6.277 0 00117.666 38a6.395 6.395 0 001.182-1.614 6.604 6.604 0 00.619-1.905 13.506 13.506 0 00.185-2.002c.004-.31.004-.61.004-.921.008-.364.008-.725.008-1.094V9.536c0-.366 0-.73-.008-1.092 0-.306 0-.614-.004-.92a13.507 13.507 0 00-.185-2.003 6.618 6.618 0 00-.62-1.903 6.466 6.466 0 00-2.798-2.8 6.768 6.768 0 00-1.908-.627 13.044 13.044 0 00-2-.176c-.305-.005-.618-.011-.922-.013-.36-.002-.725-.002-1.084-.002z"
    fill="var(--color--content__text)"
    />
    <path
    d="M8.445 39.125c-.305 0-.602-.004-.904-.01a12.687 12.687 0 01-1.87-.164 5.884 5.884 0 01-1.656-.548 5.406 5.406 0 01-1.397-1.016 5.32 5.32 0 01-1.02-1.397 5.722 5.722 0 01-.544-1.657 12.414 12.414 0 01-.166-1.875c-.007-.21-.015-.913-.015-.913v-23.1s.009-.692.015-.895a12.37 12.37 0 01.165-1.872 5.755 5.755 0 01.544-1.662 5.373 5.373 0 011.015-1.398 5.565 5.565 0 011.402-1.023 5.823 5.823 0 011.653-.544A12.586 12.586 0 017.543.887l.902-.012h102.769l.913.013a12.385 12.385 0 011.858.162 5.938 5.938 0 011.671.548 5.594 5.594 0 012.415 2.42 5.763 5.763 0 01.535 1.649 12.995 12.995 0 01.174 1.887c.003.283.003.588.003.89.008.375.008.732.008 1.092v20.929c0 .363 0 .718-.008 1.075 0 .325 0 .623-.004.93a12.731 12.731 0 01-.17 1.853 5.739 5.739 0 01-.54 1.67 5.48 5.48 0 01-1.016 1.386 5.413 5.413 0 01-1.4 1.022 5.862 5.862 0 01-1.668.55 12.542 12.542 0 01-1.869.163c-.293.007-.6.011-.897.011l-1.084.002z"
    fill="var(--color--content__background)"
    />
    <path
    d="M24.997 19.89a5.146 5.146 0 012.45-4.318 5.268 5.268 0 00-4.15-2.244c-1.746-.183-3.44 1.045-4.33 1.045-.906 0-2.276-1.027-3.752-.997a5.527 5.527 0 00-4.65 2.837c-2.012 3.482-.512 8.6 1.415 11.414.963 1.378 2.09 2.918 3.564 2.863 1.442-.06 1.981-.92 3.722-.92 1.725 0 2.23.92 3.734.886 1.548-.026 2.523-1.385 3.453-2.776a11.4 11.4 0 001.58-3.216 4.973 4.973 0 01-3.036-4.575zm-2.841-8.413a5.067 5.067 0 001.16-3.63 5.155 5.155 0 00-3.336 1.726 4.821 4.821 0 00-1.19 3.495 4.263 4.263 0 003.366-1.591zM42.302 27.14h-4.734l-1.136 3.356h-2.005l4.483-12.418h2.083l4.484 12.418h-2.04zm-4.243-1.55h3.752l-1.85-5.446h-.052zm17.101.38c0 2.813-1.507 4.62-3.78 4.62a3.07 3.07 0 01-2.848-1.583h-.043v4.484h-1.858V21.442h1.799v1.506h.034a3.212 3.212 0 012.883-1.6c2.298 0 3.812 1.816 3.812 4.622zm-1.911 0c0-1.833-.947-3.038-2.393-3.038-1.42 0-2.375 1.23-2.375 3.038 0 1.824.956 3.046 2.375 3.046 1.446 0 2.393-1.197 2.393-3.046zm11.876 0c0 2.813-1.507 4.62-3.78 4.62a3.07 3.07 0 01-2.848-1.583h-.043v4.484h-1.858V21.442h1.799v1.506h.034a3.212 3.212 0 012.883-1.6c2.297 0 3.813 1.816 3.813 4.622zm-1.911 0c0-1.833-.947-3.038-2.393-3.038-1.42 0-2.375 1.23-2.375 3.038 0 1.824.955 3.046 2.375 3.046 1.446 0 2.393-1.197 2.393-3.046zm8.496 1.066c.137 1.232 1.333 2.04 2.968 2.04 1.567 0 2.694-.808 2.694-1.919 0-.964-.68-1.54-2.29-1.936l-1.609-.388c-2.28-.55-3.339-1.617-3.339-3.348 0-2.142 1.867-3.614 4.518-3.614 2.625 0 4.424 1.472 4.484 3.614H77.26c-.112-1.239-1.136-1.987-2.634-1.987s-2.521.757-2.521 1.858c0 .878.654 1.395 2.255 1.79l1.368.336c2.548.603 3.605 1.626 3.605 3.443 0 2.323-1.85 3.778-4.793 3.778-2.753 0-4.613-1.42-4.733-3.667zM83.346 19.3v2.142h1.722v1.472h-1.722v4.991c0 .776.345 1.137 1.102 1.137a5.808 5.808 0 00.611-.043v1.463a5.104 5.104 0 01-1.032.086c-1.833 0-2.548-.689-2.548-2.445v-5.189h-1.316v-1.472h1.316V19.3zm2.718 6.67c0-2.849 1.678-4.639 4.294-4.639 2.625 0 4.295 1.79 4.295 4.639 0 2.856-1.661 4.638-4.295 4.638-2.633 0-4.294-1.782-4.294-4.638zm6.695 0c0-1.954-.895-3.108-2.401-3.108s-2.401 1.162-2.401 3.108c0 1.962.895 3.106 2.4 3.106s2.402-1.144 2.402-3.106zm3.426-4.528h1.773v1.541H98a2.16 2.16 0 012.177-1.635 2.866 2.866 0 01.637.069v1.738a2.598 2.598 0 00-.835-.112 1.873 1.873 0 00-1.937 2.083v5.37h-1.858zm13.198 6.395c-.25 1.643-1.85 2.771-3.898 2.771-2.634 0-4.269-1.764-4.269-4.595 0-2.84 1.644-4.682 4.19-4.682 2.506 0 4.08 1.72 4.08 4.466v.637h-6.394v.112a2.358 2.358 0 002.436 2.564 2.048 2.048 0 002.09-1.273zm-6.282-2.702h4.526a2.177 2.177 0 00-2.22-2.298 2.292 2.292 0 00-2.306 2.298zM37.826 8.731a2.64 2.64 0 012.808 2.965c0 1.906-1.03 3.002-2.808 3.002h-2.155V8.73zm-1.228 5.123h1.125a1.876 1.876 0 001.967-2.146 1.881 1.881 0 00-1.967-2.134h-1.125zm5.082-1.41a2.133 2.133 0 114.248 0 2.134 2.134 0 11-4.247 0zm3.334 0c0-.976-.439-1.547-1.208-1.547-.773 0-1.207.571-1.207 1.547 0 .984.434 1.55 1.207 1.55.77 0 1.208-.57 1.208-1.55zm6.559 2.254h-.922l-.93-3.317h-.07l-.927 3.317h-.913l-1.242-4.503h.902l.806 3.436h.067l.926-3.436h.852l.926 3.436h.07l.803-3.436h.889zm2.281-4.503h.855v.715h.066a1.348 1.348 0 011.344-.802 1.465 1.465 0 011.559 1.675v2.915h-.889v-2.692c0-.724-.314-1.084-.972-1.084a1.033 1.033 0 00-1.075 1.141v2.635h-.888zm5.24-1.758h.888v6.26h-.888zm2.124 4.007a2.133 2.133 0 114.247 0 2.134 2.134 0 11-4.247 0zm3.333 0c0-.976-.439-1.547-1.208-1.547-.773 0-1.207.571-1.207 1.547 0 .984.434 1.55 1.207 1.55.77 0 1.208-.57 1.208-1.55zm1.849.98c0-.81.604-1.278 1.676-1.344l1.22-.07v-.389c0-.475-.315-.744-.922-.744-.497 0-.84.182-.939.5h-.86c.09-.773.818-1.27 1.84-1.27 1.128 0 1.765.563 1.765 1.514v3.077h-.855v-.633h-.07a1.515 1.515 0 01-1.353.707 1.36 1.36 0 01-1.501-1.348zm2.895-.384v-.377l-1.1.07c-.62.042-.9.253-.9.65 0 .405.351.64.834.64a1.062 1.062 0 001.166-.983zm2.053-.596c0-1.423.732-2.324 1.87-2.324a1.484 1.484 0 011.38.79h.067V8.437h.888v6.26h-.851v-.71h-.07a1.563 1.563 0 01-1.415.785c-1.145 0-1.869-.901-1.869-2.328zm.918 0c0 .955.45 1.53 1.203 1.53.75 0 1.212-.583 1.212-1.526 0-.938-.468-1.53-1.212-1.53-.748 0-1.203.58-1.203 1.526zm6.964 0a2.133 2.133 0 114.247 0 2.134 2.134 0 11-4.247 0zm3.333 0c0-.976-.438-1.547-1.208-1.547-.772 0-1.207.571-1.207 1.547 0 .984.435 1.55 1.207 1.55.77 0 1.208-.57 1.208-1.55zm2.107-2.249h.855v.715h.066a1.348 1.348 0 011.344-.802 1.465 1.465 0 011.559 1.675v2.915h-.889v-2.692c0-.724-.314-1.084-.972-1.084a1.033 1.033 0 00-1.075 1.141v2.635h-.889zm8.845-1.121v1.141h.976v.749h-.976v2.315c0 .472.194.679.637.679a2.967 2.967 0 00.339-.021v.74a2.916 2.916 0 01-.484.046c-.988 0-1.381-.348-1.381-1.216v-2.543h-.715v-.749h.715V9.074zm2.19-.637h.88v2.481h.07a1.386 1.386 0 011.374-.806 1.483 1.483 0 011.55 1.679v2.907h-.889V12.01c0-.72-.335-1.084-.963-1.084a1.052 1.052 0 00-1.134 1.142v2.63h-.888zm9.056 5.045a1.828 1.828 0 01-1.95 1.303 2.045 2.045 0 01-2.081-2.325 2.077 2.077 0 012.076-2.352c1.253 0 2.009.856 2.009 2.27v.31h-3.18v.05a1.19 1.19 0 001.2 1.29 1.08 1.08 0 001.07-.546zm-3.126-1.451h2.275a1.086 1.086 0 00-1.109-1.167 1.152 1.152 0 00-1.166 1.167z"
    fill="var(--color--content__text)"
    />
</svg>
    </a>
    <a class="download__link" href="https://keybase.io/download">Also available for Android, Linux, Mac OS, and Windows</a>
</template>

<template id="link-linux">
    <a href="https://keybase.io/docs/the_app/install_linux" class="download__button" aria-label="Download Keybase">
<svg fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 120 40">
    <path fill="var(--color--content__text)" d="M0 0h120v40H0z"/>
    <path fill="var(--color--content__background)" d="M1 1h118v38H1z"/>
    <path fill="var(--color--content__text)" d="M100.4 8a6 6 0 00-.5 0c-4.2.4-3.1 4.8-3.2 6.3 0 1.1-.3 2-1 3-.9 1-2.1 2.8-2.7 4.6-.3.8-.4 1.6-.3 2.5h-.1l-.7 1-.8.3c-.3.2-.6.3-.8.7l-.2.6v.5c.1.4.2.8.1 1-.2.7-.3 1.2 0 1.5 0 .3.4.5.8.6.9.2 2 .1 2.8.6 1 .5 1.9.7 2.6.5.6-.1 1-.5 1.2-1l2.3-.3c.7 0 1.6.3 2.6.2l.1.3c.4.8 1.1 1.2 1.9 1.1.8 0 1.6-.5 2.2-1.3.7-.8 1.7-1 2.4-1.5.4-.2.7-.5.7-.9s-.2-.8-.7-1.3v-.1c-.2-.2-.3-.6-.4-1 0-.4-.2-.8-.5-1l-.2-.2h-.2c.5-1.3.3-2.6-.1-3.7-.6-1.4-1.5-2.6-2.2-3.5-.8-1-1.6-2-1.6-3.4 0-2.1.3-6-3.5-6.1zm.5 3.4c.2 0 .4 0 .6.2l.5.5.1.8v-.1.1l-.1.7-.2.3h-.1l-.3-.2h-.2l.1-.2.1-.4v-.5l-.2-.3-.3-.1-.3.1-.2.3v.7l-.6-.2V13v-.8l.5-.5.6-.2zm-3 0l.5.2c.1.1.3.3.3.5l.2.6v.3l-.1.1-.4.2V13v-.3l-.2-.3h-.4l-.1.4v.6c0 .2.1.2.2.3l-.2.2c-.2 0-.3-.2-.4-.4l-.1-.6a1.8 1.8 0 01.3-1.2c.2-.2.3-.2.5-.2zm1.4 1.8c.4 0 .8 0 1.2.4l1.1.4.5.4v-.1.5c-.1.3-.5.6-1 .8l-.8.5c-.3.1-.6.3-1 .3l-.5-.1-.3-.2-.6-.5c-.4-.2-.7-.5-.7-.7-.1-.3 0-.5.2-.6l.4-.3.2-.2.9-.6h.4zm2.8 2.1a24 24 0 001.8 4.5c.2.5.8 1.6 1 3h.6c.6-1.6-.6-3.4-1.1-3.9-.2-.2-.2-.3-.1-.3.6.5 1.3 1.5 1.6 2.7.1.6.2 1.1 0 1.7h.2c1 .6 1.5 1 1.3 1.6h-.2c.1-.5-.2-.9-1-1.3-1-.4-1.7-.3-1.9.5v.1l-.2.1c-.4.3-.7.7-.8 1.2l-.2 1.9-.3 1.3c-1.5 1-3.6 1.5-5.4.3l-.4-.5-.2-.3h.4l.3-.4c.2-.3 0-.7-.3-1.2s-1-1-1.8-1.5c-.6-.4-1-.9-1.1-1.4-.2-.5-.2-1 0-1.6.2-1.1.8-2.2 1.2-2.8l-.4 1c-.4.7-1.1 2.5-.1 3.8 0-1 .2-2 .6-2.9.6-1.2 1.8-3.5 1.9-5.2l.3.2.6.4c.2.2.4.4.8.4h.1c.5 0 .8-.2 1-.3l.8-.4a2 2 0 001-.7zm2.2 9c0 .6.4 1.2.9 1.3.6.2 1.4-.3 1.8-.7h.2c.3 0 .6 0 .8.2.3.2.4.6.4 1l.4 1c.5.5.7.9.7 1.1 0 .3-.2.4-.5.6-.6.4-1.8.7-2.5 1.6-.6.7-1.3 1.1-2 1.2-.7 0-1.2-.2-1.6-1-.2-.3-.1-1 0-1.6.2-.7.5-1.4.5-2l.2-1.7c.1-.5.3-.8.7-1zm-10.8 0h.2c.3 0 .7.4 1 .8l.9 1.6c.2.6.8 1.1 1.2 1.7.4.6.8 1.1.7 1.6 0 .7-.5 1.1-1.1 1.3-.7.1-1.5 0-2.4-.5-1-.5-2.1-.5-2.9-.6-.3 0-.6-.2-.7-.4l.1-1.2c.2-.4 0-.8 0-1.2v-.9c.2-.3.5-.4.7-.5.3-.2.7-.2 1-.5l.6-.8c.2-.2.4-.4.7-.4zm7.2-9c-.5.1-1 .5-1.5.5-.6 0-1-.3-1.3-.5l-.4-.3c-.1-.2-.1-.4 0-.4l.1.2.4.4c.3.2.7.4 1.2.4s1-.2 1.4-.4l.6-.5.3-.3-.2.4-.6.4zm-1.1-1.6v-.1h.3l.1.1-.1.1h-.2l-.1-.1zm-.6 0H99l-.2.1h-.1l.1-.2h.3zM18.1 14v-.9h-3.6v1.3h1.9v.1c0 1-.9 1.8-2 1.8-1.4 0-2.3-1.1-2.3-3 0-1.8.8-2.8 2.2-2.8 1 0 1.7.5 2 1.4H18c-.2-1.7-1.7-2.9-3.7-2.9-2.5 0-4 1.6-4 4.3 0 2.8 1.5 4.4 4 4.4 2.4 0 3.8-1.3 3.8-3.6zM22 12.5c.7 0 1.2.5 1.3 1.3h-2.7c0-.8.6-1.3 1.3-1.3zm1.3 3.2c-.2.5-.6.8-1.3.8-.8 0-1.4-.6-1.4-1.5v-.1h4.3v-.6c0-1.9-1.1-3.1-3-3.1-1.8 0-3 1.3-3 3.3 0 2 1.2 3.2 3 3.2 1.6 0 2.8-.8 3-2h-1.6zM26.3 9.9v1.4h-1v1.3h1V16c0 1.2.5 1.7 2 1.7h.8v-1.3h-.4c-.5 0-.7-.2-.7-.7v-3H29v-1.3H28V10h-1.7zM34.4 17.6V15l.7-1 2.6 3.6h2l-3.3-4.7 3.2-3.8h-2L34.4 13V9.1h-1.8v8.5h1.8zM42.8 12.5c.7 0 1.3.5 1.3 1.3h-2.7c0-.8.6-1.3 1.4-1.3zm1.3 3.2c-.1.5-.6.8-1.2.8-1 0-1.5-.6-1.5-1.5v-.1h4.3v-.6c0-1.9-1.1-3.1-3-3.1-1.8 0-3 1.3-3 3.3 0 2 1.2 3.2 3.1 3.2 1.6 0 2.7-.8 2.9-2h-1.6zM47.3 20c1.6 0 2.4-.6 3-2.3l2.1-6.4h-1.8l-1.3 5-1.4-5h-1.8l2.1 6.3v.3c-.1.5-.4.7-1 .7h-.5v1.3h.6zM56.8 17.7c1.6 0 2.5-1.2 2.5-3.2s-1-3.3-2.5-3.3a2 2 0 00-2 1.2V9.1h-1.7v8.5h1.7v-1a2 2 0 002 1.1zm-.6-5.1c.9 0 1.4.7 1.4 1.9 0 1.1-.5 1.8-1.4 1.8-.8 0-1.4-.7-1.4-1.8 0-1.2.6-2 1.4-2zM62.7 16.5c-.6 0-1-.3-1-.8 0-.4.4-.7 1-.8H64v.4c0 .7-.6 1.2-1.3 1.2zm-.6 1.2c.8 0 1.6-.4 2-1v.9h1.6v-4.3c0-1.3-1-2.1-2.7-2.1-1.6 0-2.7.8-2.7 2h1.5c.1-.4.5-.7 1.2-.7.6 0 1 .3 1 .9v.4l-1.6.1c-1.5 0-2.4.8-2.4 1.9 0 1.1 1 1.9 2.1 1.9zM66.7 13.2c0 1 .6 1.5 1.8 1.8l1.1.2c.6.1.8.3.8.7 0 .4-.4.6-1 .6-.7 0-1-.3-1.2-.8h-1.7c.2 1.2 1.2 2 2.9 2 1.6 0 2.7-.8 2.7-2 0-1-.5-1.4-1.8-1.7l-1-.3c-.7 0-1-.3-1-.6 0-.4.4-.7 1-.7.7 0 1 .3 1.1.8H72c0-1.2-1-2-2.7-2-1.6 0-2.6.8-2.6 2zM75.8 12.5c.8 0 1.3.5 1.3 1.3h-2.6c0-.8.6-1.3 1.3-1.3zm1.3 3.2c-.1.5-.6.8-1.2.8-.9 0-1.5-.6-1.5-1.5v-.1h4.4v-.6c0-1.9-1.2-3.1-3-3.1-1.9 0-3 1.3-3 3.3 0 2 1.1 3.2 3 3.2 1.6 0 2.7-.8 3-2H77zM10.9 31.6h1.7v-5h1.2v-1.3h-1.3V25c0-.4.3-.7.8-.7h.5v-1a5 5 0 00-.9-.1c-1.5 0-2 .5-2 1.8v.4H10v1.3h.9v5zM17.4 31.7c1.9 0 3-1.2 3-3.2s-1.1-3.3-3-3.3-3.1 1.2-3.1 3.3c0 2 1.2 3.2 3 3.2zm0-1.3c-.9 0-1.4-.7-1.4-2 0-1.2.6-2 1.4-2 .8 0 1.4.8 1.4 2 0 1.3-.6 2-1.4 2zM21.4 31.6H23v-3.5c0-.9.5-1.4 1.3-1.4h.6v-1.4h-.4c-.8 0-1.3.4-1.5 1.2v-1.2h-1.7v6.3zM33.7 30.1H30v-7h-1.7v8.5h5.4v-1.5zM34.7 31.6h1.7v-6.3h-1.7v6.3zm.8-7.1c.5 0 1-.4 1-1 0-.4-.5-.8-1-.8a.9.9 0 100 1.8zM37.5 31.6h1.7V28c0-.8.5-1.4 1.3-1.4s1.1.5 1.1 1.3v3.7h1.8v-4c0-1.5-.8-2.4-2.2-2.4-1 0-1.7.5-2 1.2v-1h-1.7v6.2zM50.2 25.3h-1.7V29c0 .9-.4 1.4-1.2 1.4-.8 0-1.2-.5-1.2-1.3v-3.7h-1.7v4c0 1.5 1 2.4 2.3 2.4 1 0 1.5-.4 1.9-1.2v1.1h1.6v-6.3zM54 29.4l1.1 2.2H57l-2-3.2 2-3h-1.9l-1 2H54l-1.1-2h-2l2 3-2 3.2h1.8l1.2-2.2z"/>
</svg>
        </a>
    <a class="download__link" href="https://keybase.io/download">Also available for Android, iOS, Mac OS, and Windows</a>
</template>

<template id="link-mac">
    <a href="https://keybase.io/docs/the_app/install_macos" class="download__button" aria-label="Download Keybase">
<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 120 40">
  <path fill="var(--color--content__text)" d="M0 0h120v40H0z"/>
  <path fill="var(--color--content__background)" d="M1 1h118v38H1z"/>
  <path fill="var(--color--content__text)" d="M15.2617 13.4492v-.9551h-3.5625v1.2891h1.8399l-.0059.1348c-.0352 1.0488-.8379 1.7578-1.9922 1.7578-1.4062 0-2.29686-1.1192-2.29686-2.9531 0-1.7989.83786-2.85942 2.23246-2.85942.955 0 1.6757.52732 1.9336 1.41212h1.7753c-.2519-1.71095-1.7402-2.87696-3.7148-2.87696-2.48437 0-4.03125 1.64066-4.03125 4.34766 0 2.748 1.54688 4.4004 4.07225 4.4004 2.3555 0 3.75-1.3945 3.75-3.6973zM19.1055 11.8496c.7617 0 1.2832.5508 1.3183 1.3535h-2.666c.0586-.7851.5977-1.3535 1.3477-1.3535zm1.3418 3.2285c-.1582.4805-.6387.791-1.2657.791-.873 0-1.4414-.6152-1.4414-1.5117v-.1054h4.3301v-.5215c0-1.9102-1.1543-3.1465-2.9824-3.1465-1.8574 0-3.0293 1.3008-3.0293 3.3047 0 2.0097 1.1602 3.2461 3.0937 3.2461 1.5528 0 2.6778-.8262 2.8653-2.0567h-1.5703zM23.4121 9.27148v1.44732h-.8848v1.289h.8848v3.2988c0 1.2246.5742 1.7168 2.0508 1.7168.3457 0 .6387-.0293.8144-.0703v-1.2597c-.1054.0175-.2636.0293-.416.0293-.5039 0-.7383-.2286-.7383-.709v-3.0059h1.1602v-1.289H25.123V9.27148h-1.7109zM31.5156 17v-2.584l.791-.9492L34.8145 17h2.1152l-3.3457-4.7051 3.1289-3.74998h-1.9688l-3.1757 3.85548h-.0528V8.54492h-1.7695V17h1.7695zM39.9414 11.8496c.7617 0 1.2832.5508 1.3184 1.3535h-2.666c.0585-.7851.5976-1.3535 1.3476-1.3535zm1.3418 3.2285c-.1582.4805-.6387.791-1.2656.791-.8731 0-1.4414-.6152-1.4414-1.5117v-.1054h4.33v-.5215c0-1.9102-1.1542-3.1465-2.9824-3.1465-1.8574 0-3.0293 1.3008-3.0293 3.3047 0 2.0097 1.1602 3.2461 3.0938 3.2461 1.5527 0 2.6777-.8262 2.8652-2.0567h-1.5703zM44.5059 19.3262c1.5996 0 2.3906-.5742 2.9238-2.1856l2.1621-6.4218h-1.8047l-1.3301 4.9101h-.0351l-1.336-4.9101h-1.875l2.1856 6.2871c.0058.0234-.0586.2753-.0586.2988-.1172.498-.4277.6973-1.0488.6973-.0645 0-.375 0-.4336-.0118v1.3184c.0586.0117.5859.0176.6504.0176zM53.957 17.0996c1.5821 0 2.5489-1.2187 2.5489-3.2402 0-2.0274-.9727-3.2403-2.5547-3.2403-.8965 0-1.5938.4454-1.9395 1.1895h-.0351V8.54492h-1.711V17h1.6875v-1.0781h.0352c.3457.7324 1.0488 1.1777 1.9687 1.1777zm-.5918-5.1094c.8496 0 1.3887.7266 1.3887 1.8692 0 1.1484-.5332 1.8633-1.3887 1.8633-.832 0-1.3945-.7266-1.3945-1.8633 0-1.125.5684-1.8692 1.3945-1.8692zM59.8223 15.8633c-.5801 0-.9668-.293-.9668-.7617 0-.4454.3633-.7325 1.0019-.7793l1.3242-.0821v.4571c0 .6797-.6152 1.166-1.3593 1.166zm-.5625 1.2363c.7851 0 1.5644-.3926 1.916-1.0605h.0351V17h1.6524v-4.3184c0-1.2656-1.0488-2.0976-2.6602-2.0976-1.664 0-2.7011.8379-2.7656 2.0566h1.5645c.082-.4629.4863-.7793 1.125-.7793.6445 0 1.0546.3399 1.0546.9258v.416l-1.582.0938c-1.5644.0937-2.4434.7558-2.4434 1.8984 0 1.1309.9083 1.9043 2.1036 1.9043zM63.8652 12.5645c0 .9433.6153 1.5527 1.8282 1.8105l1.0722.2227c.6153.1406.8321.3281.8321.6621 0 .4101-.3985.6738-1.043.6738-.6797 0-1.0723-.293-1.1777-.8438h-1.67c.1114 1.2364 1.1133 2.045 2.8477 2.045 1.6172 0 2.748-.8145 2.748-2.0508 0-.9199-.539-1.4356-1.8515-1.711l-1.0723-.2285c-.6328-.1347-.8672-.3515-.8672-.6738 0-.416.3926-.6855.9844-.6855.6328 0 1.0137.3457 1.0664.8554h1.5762c-.0352-1.2304-1.0313-2.0566-2.6426-2.0566-1.5996 0-2.6309.7851-2.6309 1.9805zM72.9648 11.8496c.7618 0 1.2832.5508 1.3184 1.3535h-2.666c.0586-.7851.5976-1.3535 1.3476-1.3535zm1.3418 3.2285c-.1582.4805-.6386.791-1.2656.791-.873 0-1.4414-.6152-1.4414-1.5117v-.1054h4.3301v-.5215c0-1.9102-1.1543-3.1465-2.9824-3.1465-1.8575 0-3.0293 1.3008-3.0293 3.3047 0 2.0097 1.1601 3.2461 3.0937 3.2461 1.5528 0 2.6778-.8262 2.8653-2.0567h-1.5704zM8.01367 31h1.71094v-4.9922h1.20699V24.748H9.68359v-.416c0-.4453.2461-.6914.80861-.6914.1699 0 .3398.0117.4629.0352v-1.1309c-.1992-.041-.5567-.0761-.8731-.0761-1.48825 0-2.06833.5742-2.06833 1.8046v.4746H7.1582v1.2598h.85547V31zM14.541 31.1348c1.8985 0 3.1113-1.2129 3.1113-3.2813 0-2.039-1.2304-3.2695-3.1113-3.2695-1.8808 0-3.1113 1.2363-3.1113 3.2695 0 2.0625 1.2129 3.2813 3.1113 3.2813zm0-1.3067c-.8437 0-1.3769-.709-1.3769-1.9687 0-1.2481.5449-1.9688 1.3769-1.9688s1.3711.7207 1.3711 1.9688c0 1.2597-.5332 1.9687-1.3711 1.9687zM18.5371 31h1.7109v-3.5098c0-.8847.4922-1.4004 1.336-1.4004.2461 0 .4805.0411.6211.0997v-1.5059c-.1172-.0352-.2871-.0645-.4863-.0645-.7383 0-1.2715.4336-1.4942 1.2305h-.0351v-1.1308h-1.6524V31zM25.2871 31h1.7109v-3.791c0-.7031.4395-1.1953 1.0899-1.1953.6328 0 1.0137.3984 1.0137 1.0722V31h1.6464v-3.8145c0-.6972.4278-1.1718 1.0782-1.1718.6621 0 1.0254.3984 1.0254 1.125V31h1.7109v-4.2891c0-1.2656-.8262-2.1093-2.0566-2.1093-.92 0-1.67.498-1.9512 1.289h-.0352c-.2109-.8203-.8437-1.289-1.7519-1.289-.8555 0-1.5293.498-1.793 1.2539h-.0351v-1.1367h-1.6524V31zM38.0723 29.8633c-.5801 0-.9668-.293-.9668-.7617 0-.4454.3633-.7325 1.0019-.7793l1.3242-.0821v.4571c0 .6797-.6152 1.166-1.3593 1.166zm-.5625 1.2363c.7851 0 1.5644-.3926 1.916-1.0605h.0351V31h1.6524v-4.3184c0-1.2656-1.0488-2.0976-2.6602-2.0976-1.664 0-2.7011.8379-2.7656 2.0566h1.5645c.082-.4629.4863-.7793 1.125-.7793.6445 0 1.0546.3399 1.0546.9258v.416l-1.582.0938c-1.5644.0937-2.4434.7558-2.4434 1.8984 0 1.1309.9083 1.9043 2.1036 1.9043zM47.9277 27.0566c-.0761-1.4238-1.1543-2.4726-2.8535-2.4726-1.8808 0-3.082 1.2539-3.082 3.2695 0 2.0508 1.2012 3.2813 3.0937 3.2813 1.6524 0 2.7598-.9551 2.8477-2.4375h-1.5938c-.1054.6855-.5507 1.0957-1.2363 1.0957-.8496 0-1.3769-.7032-1.3769-1.9395 0-1.2129.5273-1.9277 1.3711-1.9277.7031 0 1.1425.4687 1.2421 1.1308h1.5879zM52.7207 22.3984c-2.5078 0-4.0781 1.6817-4.0781 4.377 0 2.6894 1.5703 4.3711 4.0781 4.3711 2.502 0 4.0781-1.6817 4.0781-4.3711 0-2.6953-1.5761-4.377-4.0781-4.377zm0 1.4766c1.3828 0 2.2676 1.125 2.2676 2.9004 0 1.7695-.8848 2.8887-2.2676 2.8887-1.3887 0-2.2734-1.1192-2.2734-2.8887 0-1.7754.8906-2.9004 2.2734-2.9004zM57.6191 28.5859c.0528 1.5938 1.3946 2.5606 3.4102 2.5606 2.1152 0 3.4102-1.0488 3.4102-2.7012 0-1.2832-.7793-2.0039-2.5665-2.3613l-.8964-.1817c-.9961-.1992-1.4063-.5214-1.4063-1.0429 0-.6211.5859-1.0313 1.459-1.0313.8906 0 1.5176.4336 1.5762 1.1543h1.6699c-.0293-1.5527-1.2715-2.584-3.2461-2.584-1.8809 0-3.2285 1.0254-3.2285 2.5723 0 1.2598.8262 2.0684 2.5137 2.4023l.8906.1758c1.0605.2168 1.459.5332 1.459 1.0899 0 .6211-.6446 1.0781-1.5879 1.0781-.961 0-1.6758-.4219-1.7871-1.1309h-1.67zM94.7091 29.5758c-.4611-.2895-.8705-.644-1.2126-1.0535-.3734-.4242-.7194-.8703-1.0372-1.3321-.7466-1.026-1.3305-2.1483-1.7351-3.331C90.2369 22.4831 90 21.1657 90 19.8767c0-1.4383.3314-2.6934.9767-3.7469.4776-.8246 1.1892-1.5144 2.047-1.999.8285-.4856 1.7936-.7513 2.7683-.7696.3412 0 .7116.0458 1.1015.1374.2827.0733.6238.1924 1.043.339.5361.1924.8285.3115.926.339.3119.1099.5751.1557.7798.1557.156 0 .3797-.0458.6287-.1191.141-.0458.409-.1282.79-.284.376-.1283.674-.2382.911-.3206.361-.1008.71-.1924 1.023-.2382.381-.055.758-.0733 1.12-.0458.692.0458 1.325.1832 1.891.3847.994.3757 1.796.962 2.395 1.7957-.254.1465-.488.3169-.707.5038-.475.394-.877.8612-1.199 1.3788-.419.7054-.634 1.5025-.628 2.3087.015.9921.283 1.8643.819 2.6201.377.5497.881 1.0206 1.495 1.4072.302.1924.568.3252.819.4122-.117.3436-.246.678-.395 1.0078-.338.7393-.741 1.4475-1.218 2.1162-.421.5772-.753 1.0078-1.004 1.2918-.392.4397-.77.7695-1.15 1.005-.42.2611-.912.3994-1.416.3994-.341.0138-.682-.0275-1.008-.1163-.282-.0871-.561-.1851-.834-.2959-.286-.1228-.581-.2272-.882-.3115-.371-.0916-.751-.1356-1.1349-.1347-.3899 0-.77.0458-1.1307.1328-.3022.0807-.5946.1796-.8841.2978-.4094.1603-.6774.2657-.8334.3115-.3158.0879-.6395.1411-.965.1603-.5069 0-.9787-.1374-1.4485-.4123l.0127-.0119zM101.39 12.664c-.663.3115-1.292.4434-1.9231.3995-.0975-.5919 0-1.2002.2631-1.8662.234-.568.546-1.081.975-1.5391.448-.47639.984-.87033 1.589-1.15433.643-.31148 1.257-.47639 1.842-.50387.078.62297 0 1.23678-.244 1.89639-.222.58631-.553 1.12681-.974 1.61241-.425.4764-.951.8703-1.546 1.1543l.018.0009z"/>
</svg>
        </a>
    <a class="download__link" href="https://keybase.io/download">Also available for Android, iOS, Linux, and Windows</a>
</template>

<template id="link-windows">
    <a href="https://keybase.io/docs/the_app/install_windows" class="download__button" aria-label="Download Keybase">
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 120 40">
    <path fill="var(--color--content__text)" d="M0 0h120v40H0z"/>
    <path fill="var(--color--content__background)" d="M1 1h118v38H1z"/>
    <path fill="var(--color--content__text)" d="M17.3 13.4v-1h-3.6v1.4h1.8v.1c0 1-.8 1.8-2 1.8-1.4 0-2.3-1.1-2.3-3 0-1.8.9-2.8 2.3-2.8 1 0 1.7.5 2 1.4h1.7c-.3-1.7-1.8-2.9-3.7-2.9-2.5 0-4 1.6-4 4.3 0 2.8 1.5 4.4 4 4.4 2.4 0 3.8-1.3 3.8-3.7zM21.1 11.8c.8 0 1.3.6 1.3 1.4h-2.6c0-.8.6-1.4 1.3-1.4zm1.3 3.3c-.1.5-.6.8-1.2.8-.9 0-1.5-.6-1.5-1.5v-.1h4.4v-.6c0-1.9-1.2-3.1-3-3.1-1.9 0-3 1.3-3 3.3 0 2 1.1 3.2 3 3.2 1.6 0 2.7-.8 3-2h-1.7zM25.4 9.3v1.4h-.9V12h1v3.3c0 1.2.5 1.7 2 1.7h.8v-1.3h-.4c-.5 0-.8-.2-.8-.7v-3h1.2v-1.3H27V9.3h-1.7zM33.5 17v-2.6l.8-1 2.5 3.6H39l-3.3-4.7 3.1-3.8h-2l-3.1 3.9V8.5h-1.9V17h1.8z"/>
    <path fill="var(--color--content__text)" d="M42 11.8c.7 0 1.2.6 1.3 1.4h-2.7c0-.8.6-1.4 1.3-1.4zm1.3 3.3c-.2.5-.7.8-1.3.8-.9 0-1.4-.6-1.4-1.5v-.1h4.3v-.6c0-1.9-1.1-3.1-3-3.1-1.8 0-3 1.3-3 3.3 0 2 1.2 3.2 3 3.2 1.6 0 2.8-.8 3-2h-1.6zM46.5 19.3c1.6 0 2.4-.5 3-2.2l2-6.4h-1.7l-1.3 5-1.4-5h-1.9l2.2 6.3v.3c-.2.5-.5.7-1.1.7h-.4v1.3h.6zM56 17.1c1.5 0 2.5-1.2 2.5-3.2s-1-3.3-2.5-3.3a2 2 0 00-2 1.2V8.5h-1.7V17H54v-1a2 2 0 002 1.1zm-.6-5.1c.8 0 1.4.7 1.4 1.9 0 1.1-.6 1.8-1.4 1.8-.9 0-1.4-.7-1.4-1.8 0-1.2.5-2 1.4-2zM61.8 15.9c-.6 0-1-.3-1-.8 0-.4.4-.7 1-.8h1.4v.4c0 .7-.6 1.2-1.4 1.2zm-.5 1.2c.7 0 1.5-.4 1.9-1v.9H65v-4.3c0-1.3-1-2.1-2.7-2.1-1.7 0-2.7.8-2.8 2H61c0-.4.5-.7 1.1-.7.7 0 1 .3 1 .9v.4l-1.5.1c-1.6 0-2.4.8-2.4 1.9 0 1.1.9 1.9 2 1.9zM65.9 12.6c0 1 .6 1.5 1.8 1.8l1 .2c.7.1.9.3.9.7 0 .4-.4.6-1 .6-.7 0-1.1-.3-1.2-.8h-1.7c.1 1.2 1.1 2 2.9 2 1.6 0 2.7-.8 2.7-2 0-1-.5-1.5-1.8-1.7l-1.1-.3c-.7 0-.9-.3-.9-.6 0-.4.4-.7 1-.7s1 .3 1 .8h1.6c0-1.2-1-2-2.6-2s-2.6.8-2.6 2zM75 11.8c.7 0 1.2.6 1.3 1.4h-2.7c0-.8.6-1.4 1.4-1.4zm1.3 3.3c-.2.5-.6.8-1.3.8-.8 0-1.4-.6-1.4-1.5v-.1h4.3v-.6c0-1.9-1.1-3.1-3-3.1-1.8 0-3 1.3-3 3.3 0 2 1.2 3.2 3.1 3.2 1.6 0 2.7-.8 2.9-2h-1.6zM10 31h1.7v-5H13v-1.3h-1.2v-.4c0-.4.2-.7.8-.7h.5v-1a5 5 0 00-1-.1c-1.4 0-2 .5-2 1.8v.4h-.8V26h.8v5zM16.5 31.1c2 0 3.2-1.2 3.2-3.2s-1.3-3.3-3.2-3.3c-1.8 0-3 1.2-3 3.3 0 2 1.1 3.2 3 3.2zm0-1.3c-.8 0-1.3-.7-1.3-2 0-1.2.5-2 1.3-2 .9 0 1.4.8 1.4 2 0 1.3-.5 2-1.4 2zM20.5 31h1.7v-3.5c0-.9.5-1.4 1.4-1.4h.6v-1.4h-.5c-.7 0-1.3.4-1.5 1.1v-1h-1.7V31zM32.5 25.2l1.7 5.8h1.6l2.3-8.5h-1.9L35 28.7l-1.6-6.2h-1.5l-1.6 6.2-1.4-6.2H27l2.2 8.5H31l1.6-5.8zM39 31h1.6v-6.3H39V31zm.8-7.1c.5 0 .8-.4.8-1 0-.4-.3-.8-.8-.8a.9.9 0 100 1.8zM41.8 31h1.7v-3.6c0-.8.5-1.4 1.2-1.4.8 0 1.2.5 1.2 1.3V31h1.7v-4c0-1.5-.8-2.4-2.2-2.4-1 0-1.6.5-2 1.2v-1h-1.6V31zM51 31.1a2 2 0 002-1.2V31h1.7v-8.5H53v3.3a2 2 0 00-2-1.2c-1.6 0-2.6 1.3-2.6 3.2 0 2 1 3.3 2.6 3.3zm.6-5.1c.8 0 1.4.7 1.4 1.9 0 1.1-.6 1.8-1.4 1.8-.9 0-1.4-.7-1.4-1.8 0-1.2.5-2 1.4-2zM58.7 31.1c1.9 0 3.1-1.2 3.1-3.2s-1.2-3.3-3-3.3c-2 0-3.2 1.2-3.2 3.3 0 2 1.2 3.2 3.1 3.2zm0-1.3c-.8 0-1.4-.7-1.4-2 0-1.2.6-2 1.4-2 .8 0 1.4.8 1.4 2 0 1.3-.6 2-1.4 2zM71.5 24.7h-1.7l-1 4.7-1.1-4.7H66L65 29.4l-1-4.7h-1.7l1.7 6.3h1.8l1.1-4.4L68 31h1.8l1.7-6.3zM72 26.6c0 1 .6 1.5 1.8 1.8l1 .2c.7.1 1 .3 1 .7 0 .4-.5.6-1.1.6-.7 0-1.1-.3-1.2-.8h-1.7c.1 1.2 1.1 2 2.9 2 1.6 0 2.7-.8 2.7-2 0-1-.5-1.5-1.8-1.7l-1.1-.3c-.6 0-.9-.3-.9-.6 0-.4.4-.7 1-.7s1 .3 1 .8h1.7c0-1.2-1-2-2.7-2-1.6 0-2.6.8-2.6 2zM88 12.2l9-1.3v8.7h-9v-7.4zm10-1.4L110 9v10.4H98v-8.6zm-10 9.8h9v8.6L88 28v-7.4zm10 0h12V31l-11.8-1.7"/>
</svg>
        </a>
    <a class="download__link" href="https://keybase.io/download">Also available for Android, iOS, Linux, and Mac OS</a>
</template>


<template id="link-unknown">
  <a href="https://keybase.io/download" class="download__button" aria-label="Download Keybase">
  <svg viewBox="0 0 118 38" xmlns="http://www.w3.org/2000/svg">
    <rect stroke="var(--color--content__text)" fill="none"  x=".5" y=".5" width="117" height="37" rx="4.5"/>
    <path fill="var(--color-content__text)" d="M27.7 25.6a1 1 0 00-.9.6 1 1 0 00.7 1.3 1 1 0 001-.4 1 1 0 00-.8-1.5zm5.7-7.6a11 11 0 00-5.4-4.2 4 4 0 00-2.4-5.3 5 5 0 00-1.7-.3c0-.1-.1-.6.5-1.8l-1.2-.7-.3.3-1.2 1.8h-.5l-2-.1c-2.7 0-2.7 2.7-2.7 2.3v2c-.2 1.3 1 2.5 2.4 2.6h.4a11 11 0 00-2.4 1.9c-3.2 3.2-3.2 6.8-3.2 9.7v1.7l1.2-1.5c.2.7.4 1.3.8 2 .3.5.7.4 1 .3.2 0 .5-.3.2-1-.4-.9-.7-1.8-.8-2.8l2.4-3-1.3 3.8c3-2.2 8-3.2 12.1-2 1.8.5 3.5 0 4.4-1.2v-.2c.2.5.2 1 .2 1.5a12 12 0 01-.8 4.2c0 .3.1.7.5.8.4 0 .8-.2 1-.6.4-1.3.7-2.8.7-4.4 0-2-.7-4-1.9-5.8zm-13-7.4h-.9v1.1h.6v1H19a.6.6 0 01-.6-.7v-1.9c.1-.6.8-.5.8-.5h1.5l-.4 1zm7.5 9a.5.5 0 01-.7-.1l-.5-.6-1.8 1.4a.4.4 0 01-.5 0l-.9-1a.4.4 0 01.1-.6l1.8-1.4-.7-.9-1 .7a.4.4 0 01-.5 0l-.2-.2a.4.4 0 01.1-.6l.9-.7-1-1.1a.5.5 0 01.1-.7.5.5 0 01.8 0l4.1 5a.5.5 0 010 .7zm-5.3 6a1 1 0 00-.8.6 1 1 0 00.6 1.3 1 1 0 001-.4 1 1 0 00-.8-1.5z"/>
    <path fill="var(--color-content__text)" d="M49.7 15V8.3h2.4c.5 0 1 .1 1.4.3a3.1 3.1 0 011.8 1.7 3.5 3.5 0 010 2.7 3 3 0 01-1.8 1.8l-1.4.2h-2.4zm2.4-.9c.4 0 .8 0 1-.2.4-.1.6-.3.8-.5l.5-.8.1-1-.1-.9a2.2 2.2 0 00-1.2-1.3l-1-.2h-1.5v5h1.4zm6.8 1c-.4 0-.7 0-1-.2l-.8-.5-.5-.8a2.8 2.8 0 01.5-2.8A2.3 2.3 0 0159 10c.4 0 .7.1 1 .3.3 0 .6.3.8.5l.5.8.2 1-.2 1-.5.8-.8.5c-.3.2-.6.2-1 .2zm0-.8l.7-.1.4-.4.3-.6a2.2 2.2 0 000-1.3c0-.2-.2-.4-.3-.5a1.4 1.4 0 00-1-.6l-.7.2c-.2 0-.4.2-.5.4l-.3.5v1.4c0 .2.2.3.3.5a1.4 1.4 0 001.1.5zm7.8.7l-1.2-3.7-1.2 3.7h-1L62 10.2h.9l1 3.7 1.3-3.7h.8l1.2 3.7 1-3.7h1L67.6 15h-1zm6.5 0v-3c0-.5-.1-.8-.3-1l-.7-.2c-.3 0-.6.1-.8.3l-.6.5V15H70v-4.8h1v.7a2 2 0 01.6-.6 2.2 2.2 0 011-.3c.6 0 1 .2 1.2.4.3.3.4.7.4 1.2V15h-1zm2.3 0V8.3h1V15h-1zm4.5.1c-.4 0-.7 0-1-.2l-.8-.5-.5-.8a2.8 2.8 0 01.5-2.8A2.3 2.3 0 0180 10c.4 0 .7.1 1 .3.3 0 .6.3.8.5l.5.8.1 1-.1 1-.5.8-.8.5c-.3.2-.6.2-1 .2zm0-.8l.6-.1.5-.4.3-.6a2.2 2.2 0 000-1.3c0-.2-.2-.4-.3-.5a1.4 1.4 0 00-1.1-.6l-.6.2c-.2 0-.4.2-.5.4l-.3.5-.1.7v.7l.4.5a1.4 1.4 0 001 .5zm6.6.7v-.5a2 2 0 01-.7.5l-1 .1h-.5l-.6-.4a1.5 1.5 0 01-.5-1.2l.1-.7.4-.5.6-.3h.6l.9.1.7.5v-.8c0-.3-.2-.6-.4-.7-.2-.2-.5-.3-.8-.3a2 2 0 00-1.5.7l-.4-.7c.6-.5 1.2-.8 2-.8l.8.1a1.6 1.6 0 011 .9l.2.7V15h-1zm-1.3-.5c.3 0 .5 0 .7-.2.2 0 .4-.2.6-.4v-.8l-.6-.4-.7-.1c-.3 0-.6 0-.8.2-.2.2-.3.4-.3.7 0 .3.1.6.3.7.2.2.5.3.8.3zm7 .5v-.7c-.1.3-.4.4-.7.6l-.8.2c-.4 0-.6 0-1-.2a2 2 0 01-.6-.5l-.4-.8-.2-1c0-.4 0-.7.2-1 0-.4.2-.6.4-.9a2 2 0 011.6-.6c.3 0 .6 0 .8.2.3.1.5.3.7.6V8.3h1V15h-1zm-1.3-.7c.3 0 .5 0 .8-.2l.5-.5v-2c0-.2-.3-.4-.5-.5a1.5 1.5 0 00-1.4-.1c-.2 0-.3.2-.5.3l-.3.6v1.4l.3.5a1.3 1.3 0 001.1.5zM55.5 29l-2.9-3.7-.7.8V29h-2v-9.3h2v4.1l3.3-4.1h2.5L54 24l4 5h-2.5zm6 .2c-.4 0-1-.1-1.4-.3l-1.1-.7a3.4 3.4 0 01-1-2.6c0-.5 0-1 .2-1.4a3.5 3.5 0 011.9-1.8 3.5 3.5 0 012.7 0c.5.1.8.4 1.1.7.3.3.5.7.7 1.2.2.4.3 1 .3 1.5v.4h-5c0 .4.2.8.5 1 .3.4.8.6 1.4.6a2.8 2.8 0 001.8-.7l.8 1.1c-.4.3-.8.6-1.3.7a5 5 0 01-1.5.3zm1.6-4.2v-.5l-.4-.5-.5-.4-.7-.1-.8.1-.5.4-.3.5-.1.5h3.3zm3 5l.3.1H67.3l.4-.4.2-.6-2.7-6.9H67l1.7 4.7 1.8-4.7h2l-3.3 8c-.2.5-.6 1-1 1.2a3.4 3.4 0 01-2 .3H66l.3-1.6zm9-3.2l.7.6.8.2c.5 0 1-.2 1.3-.5.3-.4.4-.9.4-1.5s-.1-1-.4-1.4c-.3-.4-.8-.5-1.3-.5-.3 0-.6 0-.8.2-.3.1-.6.3-.7.5v2.4zM73.3 29v-9.3h1.8V23a2.6 2.6 0 012-1 2.8 2.8 0 012.2 1c.3.2.5.6.7 1l.2 1.5c0 .6-.1 1-.3 1.5-.1.5-.3.8-.6 1.1-.3.3-.6.6-1 .7a3 3 0 01-1.1.3l-1.2-.3-1-.8v.9h-1.7zm12.3 0v-.7c-.3.3-.6.5-1 .6-.3.2-.7.3-1.2.3a2.6 2.6 0 01-1.5-.6c-.3-.2-.5-.4-.6-.7l-.2-1c0-.4 0-.7.2-1 .1-.3.3-.5.6-.7.2-.1.4-.3.7-.3l.8-.2c.5 0 .9.1 1.3.3.4 0 .7.3.9.6v-1a1 1 0 00-.4-.8c-.3-.2-.7-.3-1.1-.3-.8 0-1.4.3-2 .8l-.7-1.2a4 4 0 011.4-.8 4.8 4.8 0 012.7-.1c.4 0 .7.2 1 .4l.6.8c.2.3.3.7.3 1.2V29h-1.8zm-1.4-1c.2 0 .5 0 .8-.2.2 0 .4-.2.6-.4v-.9l-.6-.4-.8-.2c-.4 0-.7.1-1 .3-.2.2-.3.4-.3.8 0 .3.1.5.3.7.3.2.6.3 1 .3zm7.4 1.2c-.6 0-1.2-.1-1.7-.3-.6-.2-1-.5-1.4-.8l.8-1.2.5.3.5.3.7.2.6.1c.4 0 .7 0 .9-.2.2-.1.3-.3.3-.5l-.1-.3-.3-.2-.5-.1a15.9 15.9 0 00-1.4-.4c-.3 0-.6-.2-.8-.3l-.7-.6c-.2-.3-.2-.6-.2-1l.1-.8.6-.7.8-.4c.4-.2.8-.2 1.2-.2.6 0 1.1 0 1.6.2l1.2.7-.8 1.2c-.2-.2-.4-.4-.8-.5-.4-.2-.7-.3-1.2-.3-.3 0-.5 0-.7.2-.2.2-.3.3-.3.5s0 .3.3.4l1 .3c.3 0 .6 0 .9.2l.9.3.6.7c.2.2.3.6.3 1 0 .3 0 .6-.2.9a2 2 0 01-.6.7l-.9.4-1.2.2zm7.4 0l-1.5-.3-1.1-.7a3.4 3.4 0 01-1-2.6c0-.5 0-1 .2-1.4a3.5 3.5 0 011.8-1.8 3.5 3.5 0 012.8 0c.5.1.8.4 1.1.7.3.3.5.7.7 1.2.2.4.2 1 .2 1.5v.4h-5c0 .4.3.8.6 1 .3.4.8.6 1.4.6a2.8 2.8 0 001.8-.7l.8 1.1c-.4.3-.8.6-1.3.7a5 5 0 01-1.5.3zm1.5-4.2v-.5l-.4-.5-.5-.4-.7-.1-.8.1-.5.4-.3.5-.1.5h3.3z"/>
  </svg>
  </a>
</template>

<div class="download">
  <div class="download__title">Get Keybase</div>
  <p class="download__description">
    Keybase is a safe, secure, and private app for everything you do online.
  </p>
</div>
<script>
let ua = window.navigator.userAgent;
let platform = 'unknown';

if (ua.indexOf('Android') !== -1) { platform = 'android'; }
else if (ua.indexOf('Linux') !== -1) { platform = 'linux'; }
else if (ua.indexOf('Windows') !== -1) { platform = 'windows'; }
else if (ua.indexOf('Win32') !== -1) { platform = 'windows'; }
else if (ua.indexOf('iPhone') !== -1) { platform = 'ios'; }
else if (ua.indexOf('iPad') !== -1) { platform = 'ios'; }
else if (ua.indexOf('Mac OS') !== -1) { platform = 'mac'; }

let temp = document.querySelector('#link-' + platform);
let clone = temp.content.cloneNode(true);

document.querySelector("div.download").appendChild(clone);
</script>
    <span class="site-footer__copyright">(C) Keybase — 2022</span>
    <span class="site-footer__disclaimer">Keybase Book is <a href="https://github.com/keybase/book-content/">open source</a>.</span>
  </div>
</footer>
  </body>
</html>